# Data Model: Interactive Tools Filter Page

**Feature**: `002-tools-filter`  
**Date**: 2025-10-31  
**Status**: Draft

## Purpose

This document defines the data structures, entities, and their relationships for the interactive tools filter page feature.

## Entities

### 1. Tool

Represents a software quality assurance tool loaded from `data/tools.json`.

**Source**: JSON file at `/data/tools.json` (generated by Excel-to-JSON automation)

**Structure**:

```typescript
interface Tool {
  // Identity
  Tools: string;                    // Tool name (e.g., "GitHub Advanced Security")
  Description: string;              // Tool description
  
  // Classification
  Familly: string;                  // Category (e.g., "SAST/DAST", "DevOps", "Testing")
  Type: string;                     // Deployment type (e.g., "Agent", "Core", "Plugin", "UI")
  
  // Metrics (1-5 scale)
  "Security Level (1 = very light output, 5 = rich output)": number | null;
  "Importance (1 = specific, 5 = important)": number | null;
  "Implementation complexity  (1 = easy, 5 = complex)": number | null;
  "Use AI  (1 = not at all, 5 = built on AI)": number | null;
  
  // Attributes
  Maturity: string;                 // e.g., "High", "Medium", "Low"
  "Type of deployment needed": string; // e.g., "CI/CD", "Build", "Runtime"
  
  // Boolean Filters
  "Is Local": boolean;              // Can be run locally
  "Is Microsoft": boolean;          // Microsoft product
  API: boolean;                     // Has API access
  "Available as quality gate": boolean; // Can be used as quality gate
  
  // Metadata
  Owner: string;                    // Team responsible
  "Product Link": string;           // Official URL
  "Logo URL": string;               // Logo image URL
  
  // Lifecycle Phase Coverage (nullable booleans)
  Code: boolean | null;
  Build: boolean | null;
  Test: boolean | null;
  release: boolean | null;
  deploy: boolean | null;
  operate: boolean | null;
  monitor: boolean | null;
  plan: boolean | null;
  
  Demo: string | null;              // Demo URL if available
}
```

**Validation Rules**:

- `Tools` field MUST NOT be empty (required for display)
- `Description` SHOULD be present but can be empty string
- `Familly` MUST be one of the known categories (extracted dynamically from dataset)
- `Type` MUST be one of the known types (extracted dynamically from dataset)
- Boolean fields MUST be `true`, `false`, or `null` (not strings)
- Numeric metrics MUST be 1-5 or `null`
- URLs SHOULD be valid HTTP/HTTPS URLs or empty string

**Null Handling**:

- `null` values in boolean filter fields mean "not applicable" or "unknown"
- Tools with `null` in a boolean field will NOT match filters for that field
- Example: If `Is Microsoft` is `null`, tool won't appear in "Is Microsoft" filter results

---

### 2. FilterState

Represents the current user-selected filters and search query.

**Purpose**: Track active filters to determine which tools to display

**Structure**:

```typescript
interface FilterState {
  // Dropdown filters (null = "All" / no filter)
  selectedCategory: string | null;  // Matches Tool.Familly
  selectedType: string | null;      // Matches Tool.Type
  
  // Boolean filters (null = unchecked, true = checked)
  filterIsMicrosoft: boolean | null;
  filterIsLocal: boolean | null;
  filterHasAPI: boolean | null;
  filterQualityGate: boolean | null;
  
  // Text search
  searchQuery: string;              // Case-insensitive partial match on Tool.Tools
}
```

**Initial State**:

```typescript
const initialFilterState: FilterState = {
  selectedCategory: null,
  selectedType: null,
  filterIsMicrosoft: null,
  filterIsLocal: null,
  filterHasAPI: null,
  filterQualityGate: null,
  searchQuery: ""
};
```

**State Transitions**:

- User selects category → `selectedCategory` = category name
- User selects "All categories" → `selectedCategory` = null
- User checks "Is Microsoft" → `filterIsMicrosoft` = true
- User unchecks "Is Microsoft" → `filterIsMicrosoft` = null
- User types in search → `searchQuery` = input value
- User clicks "Clear All Filters" → reset to initial state

---

### 3. FilterOptions

Represents the available filter options extracted from the dataset.

**Purpose**: Populate dropdown menus with actual values from data

**Structure**:

```typescript
interface FilterOptions {
  categories: string[];  // Unique values from Tool.Familly (sorted alphabetically)
  types: string[];       // Unique values from Tool.Type (sorted alphabetically)
}
```

**Extraction Logic**:

```typescript
function extractFilterOptions(tools: Tool[]): FilterOptions {
  const categories = [...new Set(tools.map(t => t.Familly))].sort();
  const types = [...new Set(tools.map(t => t.Type))].sort();
  
  return { categories, types };
}
```

**Example**:

```typescript
{
  categories: ["SAST/DAST", "DevOps", "Testing", "Utility", "Monitoring"],
  types: ["Agent", "Core", "Plugin", "UI"]
}
```

---

## Data Flow

### Loading Flow

1. **Page Load** → Show loading indicator
2. **Fetch** `data/tools.json` via HTTP GET
3. **Parse** JSON response to `Tool[]` array
4. **Validate** structure (check required fields exist)
5. **Extract** filter options from dataset
6. **Render** initial UI: all tools + filter dropdowns
7. **Hide** loading indicator

### Filtering Flow

1. **User Action** → Change filter control (dropdown, checkbox, search)
2. **Capture** new filter state from form
3. **Apply** filter logic to `Tool[]` array
4. **Render** filtered results to DOM
5. **Update** result count display

### Filter Logic (AND Combination)

A tool is displayed if ALL of these conditions are true:

- **Category Match**: `selectedCategory === null OR tool.Familly === selectedCategory`
- **Type Match**: `selectedType === null OR tool.Type === selectedType`
- **Microsoft Match**: `filterIsMicrosoft === null OR tool["Is Microsoft"] === true`
- **Local Match**: `filterIsLocal === null OR tool["Is Local"] === true`
- **API Match**: `filterHasAPI === null OR tool.API === true`
- **Quality Gate Match**: `filterQualityGate === null OR tool["Available as quality gate"] === true`
- **Search Match**: `searchQuery === "" OR tool.Tools.toLowerCase().includes(searchQuery.toLowerCase())`

**Pseudocode**:

```typescript
function filterTools(tools: Tool[], state: FilterState): Tool[] {
  return tools.filter(tool => {
    // Category filter
    if (state.selectedCategory !== null && tool.Familly !== state.selectedCategory) {
      return false;
    }
    
    // Type filter
    if (state.selectedType !== null && tool.Type !== state.selectedType) {
      return false;
    }
    
    // Boolean filters (only apply if checkbox is checked)
    if (state.filterIsMicrosoft === true && tool["Is Microsoft"] !== true) {
      return false;
    }
    if (state.filterIsLocal === true && tool["Is Local"] !== true) {
      return false;
    }
    if (state.filterHasAPI === true && tool.API !== true) {
      return false;
    }
    if (state.filterQualityGate === true && tool["Available as quality gate"] !== true) {
      return false;
    }
    
    // Search filter
    if (state.searchQuery !== "" && 
        !tool.Tools.toLowerCase().includes(state.searchQuery.toLowerCase())) {
      return false;
    }
    
    return true; // Passed all filters
  });
}
```

---

## Error Handling

### JSON Loading Errors

**Scenario**: `fetch('/data/tools.json')` fails (404, network error, etc.)

**Handling**:
- Catch error in promise chain
- Display user-friendly error message: "Unable to load tools data. Please refresh the page."
- Hide loading indicator
- Log error to console for debugging

### JSON Parse Errors

**Scenario**: Response is not valid JSON

**Handling**:
- Catch JSON.parse() error
- Display error message: "Data format error. Please contact support."
- Hide loading indicator
- Log error details to console

### Invalid Data Structure

**Scenario**: JSON is valid but doesn't match expected Tool structure (missing fields)

**Handling**:
- Validate that array exists and has length > 0
- Skip tools with missing `Tools` field (required)
- Render tools with partial data (use fallbacks for missing fields)
- Log warnings for malformed entries

### No Results After Filtering

**Scenario**: Filter combination returns empty array

**Handling**:
- Display "No tools found matching your filters" message
- Show "Clear All Filters" button prominently
- Keep filter state visible so user can adjust

---

## Performance Considerations

### Dataset Size

- Current: 58 tools
- Expected: Up to ~100 tools in future
- Filter/search operations on this scale: <10ms

### Optimization Strategy

- **No pagination needed**: All tools fit in viewport with scroll
- **Batch DOM updates**: Use DocumentFragment to render filtered results
- **Debounce search**: Wait 250ms after user stops typing before filtering
- **Lazy-load images**: Use `loading="lazy"` attribute for tool logos
- **Cache filter options**: Extract once on load, reuse for all filter operations

---

## Testing Validation

### Data Integrity Tests

- Verify all 58 tools load correctly
- Check that filter options extraction produces expected categories/types
- Validate that tools with null boolean values are handled correctly

### Filter Logic Tests

- Single filter: Category filter shows only matching tools
- Combined filters: Category + Type shows only tools matching both
- Boolean filters: Checking "Is Microsoft" shows only Microsoft tools
- Search: Typing "GitHub" shows only tools with "GitHub" in name
- Case insensitivity: Search for "github" matches "GitHub"
- Clear All: Resets all filters and shows all tools

### Edge Case Tests

- No results: Apply filters that match zero tools
- Null values: Filter boolean field where some tools have null
- Special characters: Search for tool names with hyphens, numbers
- Empty search: Search box with empty string shows all tools (respecting other filters)

---

## Future Considerations

### Potential Enhancements (Out of Scope for v1)

- **Multi-select filters**: Allow selecting multiple categories simultaneously
- **Advanced search**: Search in description field, not just tool name
- **Sort options**: Sort by name, maturity, importance
- **URL persistence**: Store filter state in URL query params for sharing
- **Export results**: Download filtered list as CSV or JSON
- **Saved filters**: Save common filter combinations for quick access

These enhancements are noted here for future planning but are NOT part of the current feature scope.
